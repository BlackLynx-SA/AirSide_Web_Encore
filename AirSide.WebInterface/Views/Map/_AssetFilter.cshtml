<div class="modal fade" id="assetFilterModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                    &times;
                </button>
                <h4 class="modal-title"><i class="fa fa-lightbulb-o txt-color-green fa-2x"></i> @Resources.Language.Asset_Filter</h4>
            </div>
            <div class="modal-body">
                <form class="smart-form">
                    <div class="row">
                        <section class="col col-10">
                            <label class="radio">
                                <input type="radio" name="assetFilterRadio" checked="checked" value="allassets" id="allAssetRadio">
                                <i></i>@Resources.Language.All_Assets
                            </label>
                        </section>
                    </div>
                    <div class="row">
                        <section class="col col-10">
                            <label class="radio">
                                <input type="radio" name="assetFilterRadio" value="asset" id="assetTypeRadio">
                                <i></i>@Resources.Language.Show_Specific_Asset_Type
                            </label>
                            <label class="select">
                                @Html.DropDownList("assetClasses", null, String.Empty)<i></i>
                            </label>
                            <div class="note"><strong><i class="fa fa-hand-o-right"></i> @Resources.Language.Note</strong> @Resources.Language.This_Is_All_Asset_Types <a href="~/assetclass/assetclasses">@Resources.Language.Here.</a></div>
                        </section>
                    </div>

                    <div class="row">
                        <section class="col col-10">
                            <label class="radio">
                                <input type="radio" name="assetFilterRadio" value="maintain" id="assetMaintenanceRadio">
                                <i></i>@Resources.Language.Maintenance_Cycle
                            </label>
                        </section>
                    </div>

                    <div class="row">
                        <section class="col col-10">
                            <label class="select">
                                <select id="maintenanceSelect">
                                    <option value="0" selected="selected">@Resources.Language.No_Data</option>
                                    <option value="1">>@Resources.Language.Recently_Updated</option>
                                    <option value="2">>@Resources.Language.Mid_Cycle</option>
                                    <option value="3">>@Resources.Language.Almost_Due</option>
                                    <option value="4">>@Resources.Language.Over_Due</option>
                                </select><i></i>
                            </label>
                            <div class="note"><strong><i class="fa fa-hand-o-right"></i> @Resources.Language.Note</strong> @Resources.Language.Filter_According_to_Cycle</div>
                        </section>
                    </div>
                    <hr /><br />
                    <div class="row">
                        <section class="col col-10">
                            <label class="checkbox">
                                <input id="clusteredChk" type="checkbox" name="checkbox">
                                <i></i>Show Asset Clustered
                            </label>
                            <div class="note"><strong><i class="fa fa-lightbulb-o"></i> @Resources.Language.Note</strong> @Resources.Language.Cluster_Visualize</div>
                        </section>

                    </div>
                    <div class="row">
                        <section class="col col-11">
                            <img src="~/Content/img/adb_img/adb_loader_tr.gif" id="assetLoader" style="height:15px; display:none;" />
                        </section>
                    </div>
                </form>
            </div>
            <div class="modal-footer">

                <button class="btn btn-sm btn-primary" style="float:right" id="assetFilterBtn">@Resources.Language.Apply_Filter</button>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">

    function filterAssets(all) {
        $('#assetLoader').fadeIn(500);

        //Clear Map
        clearAllMarkers();
        markerClusterer.clearMarkers();

        var clustered = $('#clusteredChk').prop("checked");
        var filterType = "allassets";
        if (!all)
            filterType = $('input[name=assetFilterRadio]:checked').val();

        filterType = $('input[name=assetFilterRadio]:checked').val();
        if (filterType === 'allassets') {
            showAllAssets(clustered);
            filterEnum = 101;
            filterValue = 0;
        } else if (filterType === 'maintain') {
            var cycle = $('#maintenanceSelect').val();
            showMaintenanceCycle(cycle, clustered);
            filterEnum = 103;
            filterValue = cycle;
        } else if (filterType === 'asset') {
            var asset = $('#assetClasses').val();
            showAssetClass(asset, clustered);
            filterEnum = 102;
            filterValue = asset;
        }
        $('#assetFilterModal').modal('hide');
        $('#assetLoader').hide();
        lastFilter = "assets";
    }

    //Asset Filters
    function showAllAssets(clustered) {
        markers = [];
        $.each(Assets.jsonData, function (i,v) {
            var flag = false;
            $.each(v.maintenance, function (index, value) {
                if (value.maintenanceId === selectedTask) {
                    addMarker(v);
                    return false;
                }
            });
        });
        if (clustered) markerClusterer = new MarkerClusterer(map, markers);
    }

    function showAssetClass(asset, clustered) {
        markers = [];
        $.each(Assets.jsonData, function (i,v) {
            if (asset === v.assetClass.assetClassId.toString()) {
                $.each(v.maintenance, function (index, value) {
                    if (value.maintenanceId === selectedTask) {
                        addMarker(v);
                        return false;
                    }
                });
            }
        });

        if (clustered) markerClusterer = new MarkerClusterer(map, markers);
    }

    function showMaintenanceCycle(cycle, clustered) {
        var i = 0;
        markers = [];
        $.each(Assets.jsonData, function (i, v) {
            $.each(v.maintenance, function (index, value) {
                if (value.maintenanceId === selectedTask) {
                    if (cycle === value.maintenanceCycle) {
                        //Add Marker to Map
                        addMarker(v);
                        return false;
                    }
                }
            });
        });

        if (clustered) markerClusterer = new MarkerClusterer(map, markers);
    }
</script>
